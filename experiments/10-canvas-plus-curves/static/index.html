<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <style type="text/css" media="all">
      #viewport {
        position: relative;
        width: 100%;
        height: 100%;
      }:
      image {
        position: absolute;
        top: 0;
        left: 0:
      }
    </style>
  </head>
  <body>
    <div id="viewport">
      <div id="img1"></div>
      <div id="img2"></div>
    </div>
    <script src="canvas-plus.js"></script>
    <script>
      let childId;
      setInterval(function () {
        var canvas = new CanvasPlus();

        canvas.load("kaidoteam.png", function (err) {
          if (err) throw err;
          canvas.resize({
            width: 640,
            height: 480,
            mode: "fit",
          });

          const randomNumber = (number) => {
            return Math.round(Math.random() * 255);
          };
          const rnd255 = function () {
            const n = randomNumber(255);
            // console.log(n);
            return n;
          };

          canvas.curves({
            red: [0, rnd255(), rnd255(255), rnd255(255), 255],
            green: [0, rnd255(), rnd255(255), rnd255(255), 255],
            blue: [0, rnd255(), rnd255(255), rnd255(255), 255],
            alpha: [0, rnd255(), rnd255(255), rnd255(255), 255],
          });

          canvas.write({ format: "png", quality: 90 }, function (err, buf) {
            if (err) throw err;

            // 'buf' will be a binary buffer containing final image...
            var blob = new Blob([buf], { type: "image/png" });
            var object_url = URL.createObjectURL(blob);

            // insert new image into DOM
            var img = new Image();
            img.src = object_url;
            const viewport = document.getElementById("viewport");
            if (childId) viewport.removeChild(childId);
            childId = viewport.appendChild(img);
            //consola.info(res);
          });
        });
      }, 1000);
    </script>
  </body>
</html>
